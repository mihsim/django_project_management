{% extends 'base.html' %}

{% block title %}|Projects{% endblock %}

{% block sidebar %}
    {% include 'projects/sidebar.html' %}
{% endblock %}

{% block body_title %}
    Projects
{% endblock %}

{% block body_content %}

    {# Prints out list of projects user is administrator to. #}
    {% if administrator_to_projects %}
        <ul class="table_wrapper">
            <li class="table_line">
                <h3 class="line_item">You are administrator to:</h3>
            </li>
            {% for project in administrator_to_projects %}
                <li class="table_line">
                    <a href="{% url "project:project" project.id %}" class="line_item">{{ project }}</a>
                </li>
            {% endfor %}
        </ul>
    {% endif %}

    {# Prints out list of projects user is participating, but is not administrator to. #}
    {% if participations_to_projects %}
        <ul class="table_wrapper">
        <li class="table_line">
            <h3 class="line_item">You are contributor to:</h3>
        </li>

            {% for participation in participations_to_projects %}
                <li class="table_line">
                    <a href="{% url "project:project" participation.project.id %}" class="line_item">{{ participation.project.name }}</a>
                </li>
            {% endfor %}
        </ul>
    {% endif %}


    {# Prints out list of projects that user is invited to. #}
    {% if invitations_to_projects %}
        <h3>You are invited to:</h3>
        {% for invitation in invitations_to_projects %}
            {% if invitation.status != "Declined"  %}
                <li class="list-group-item">
                    <form role="form"  action="{% url 'project:invitation' invitation.id 'accept' %}" method="POST" class="row">
                        {% csrf_token %}
                        <div class="col">{{ invitation.project.name }}</div>
                        <div class="col-auto">
                            <button class="btn btn-outline-secondary btn-sm" type="submit" formaction="{% url 'project:invitation' invitation.id 'decline' %}">Decline</button>
                            <button class="btn btn-outline-success btn-sm" type="submit">Accept</button>
                        </div>
                    </form>
                </li>
            {% endif %}
        {% endfor %}
    {% endif %}

{% endblock %}